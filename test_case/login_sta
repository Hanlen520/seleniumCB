# coding=utf-8
from selenium import webdriver
from time import sleep
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.support.select import Select

driver = webdriver.Firefox(executable_path='./../drivers/geckodriver')
driver.get("https://192.168.0.245:9444/s1gcb/logon/loginSSO")
loginID = WebDriverWait(driver, 30, 1).until(EC.visibility_of_element_located((By.NAME, "ssoUserid")))
loginID.send_keys("SG2BFE1S04")
companyID = WebDriverWait(driver, 30, 1).until(EC.visibility_of_element_located((By.NAME, "ssoCompanyID")))
companyID.send_keys("SG2BFE1")
loginBtn = WebDriverWait(driver, 30, 1).until(EC.element_to_be_clickable((By.NAME, "submit_sbuserLogin")))
loginBtn.click()
nextBtn = WebDriverWait(driver, 30, 1).until(EC.element_to_be_clickable((By.ID, "previewButton_Link")))
nextBtn.click()
sleep(10)
paymentMenu = WebDriverWait(driver, 30, 1).until(EC.visibility_of_element_located((By.ID, "pmt")))
driver.execute_script("document.getElementById('pmt').parentElement.children[1]."
                      + "style='opacity:1; margin-left: 0; width:320px;'")
sleep(2)
TTlink = WebDriverWait(driver, 30, 1).until(EC.element_to_be_clickable((By.LINK_TEXT, "Telegraphic Transfer")))
TTlink.click()
sleep(30)

'''fromAccount = WebDriverWait(driver, 30, 1).until(EC.element_to_be_clickable((By.ID, "fromParty")))
fromAccount.click()'''
fromaccount_selector = Select(driver.find_element_by_id('fromParty'))
fromaccount_selector.select_by_visible_text('LEONA ALBRECHT - 0018001843 - SGD')



driver.find_element_by_id("paymentCurrency_currencyCode").click()
driver.find_element_by_css_selector("option[value='SGD']").click()


sleep(20)
driver.close()
